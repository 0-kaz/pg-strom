<article><h1 id="tutrial">  <span lang="en">User Tutrial</span>  <span lang="ja">チュートリアル</span></h1><section><h2 id="basic-operations">  <span lang="en">Basic Operations</span>  <span lang="ja">基本的な操作</span></h2><h3 id="tutrial-pgstrom_enabled"><span lang="en">Turn On/Off PG-Strom</span><span lang="ja">PG-Stromの有効化/無効化</span></h3><p><span lang="en">You can turn on/off <tt>PG-Strom</tt> functionality using <tt>pg_strom.enabled</tt> configuration parameter.</span><span lang="ja"><tt>pg_strom.enabled</tt>パラメータを使用して<tt>PG-Strom</tt>機能の有効/無効を切替える事ができます。</span></p><pre># SET pg_strom.enabled = off;</pre><p><span lang="en">The above is the command to turn off the <tt>PG-Strom</tt>, and, the below is the command to turn on <tt>PG-Strom</tt> again.</span><span lang="ja">上記が<tt>PG-Strom</tt>を無効化するコマンド、そして、下記が<tt>PG-Strom</tt>を再び有効化するコマンドです。</span></p><pre># SET pg_strom.enabled = on;</pre><p><span lang="en">You can turn off <tt>PG-Strom</tt> on troubles, then confirm whether the problem is reproducible with no <tt>PG-Strom</tt> support.</span><span lang="ja">トラブル時にはこれらのコマンドを用いて<tt>PG-Strom</tt>を無効化し、その状態でも問題が再現可能かどうかを確認する事ができます。</span></p><div class="hint"><p><span lang="en">The command below allows to turn on/off <tt>PG-Strom</tt> from out of the session.It is convenient to have performance benchmark according to existence of <tt>PG-Strom</tt>, if application construct and send queries to <tt>PostgreSQL</tt> directly.</span><span lang="ja">以下のコマンドを用いることで、セッションの外部から<tt>PG-Strom</tt>の有効・無効を切り替えることができます。これは、アプリケーションが直接<tt>PostgreSQL</tt>にクエリを発行するような状況で、<tt>PG-Strom</tt>の有無に伴う性能差をベンチマークするケースなどで有用です。</span></p><pre># ALTER SYSTEM SET pg_strom.enabled TO off;# SELECT pg_reload_conf();</pre></div><h3 id="tutrial-operation-checks"><span lang="en">Operation Checks of PG-Strom</span><span lang="ja">PG-Stromの動作確認</span></h3><p><span lang="en">EXPLAIN command displays the query execution plan. Once PG-Strom gets a role to execute a part of the given query workloads, it shall be shown as <tt>CustomScan</tt> node; implemented by <tt>PG-Strom</tt>.</span><span lang="ja">EXPLAINコマンドを用いてクエリ実行計画を表示することができます。<tt>PG-Strom</tt>がクエリ処理の一部を実行することになると、その部分は<tt>PG-Strom</tt>によって実装された<tt>CustomScan</tt>ノードとして表示されます。</span></p><pre>postgres=# EXPLAIN           SELECT cat, avg(ax) FROM t0 NATURAL JOIN t1 NATURAL JOIN t2 GROUP BY cat;                                    QUERY PLAN----------------------------------------------------------------------------------- HashAggregate  (cost=2347813.66..2347813.98 rows=26 width=12)   Group Key: t0.cat   ->  Custom Scan (GpuPreAgg)  (cost=14189.15..1878462.46 rows=234 width=44)         Bulkload: On (density: 99.33%)         Reduction: Local + Global         ->  Custom Scan (GpuJoin)  (cost=10189.15..1851180.43 rows=99326645 width=12)               Bulkload: On (density: 100.00%)               Depth 1: GpuHashJoin, HashKeys: (bid), JoinQual: (bid = bid)                        Nrows (in/out: 99.33%), KDS-Hash (size: 12.04MB, nbatches: 1)               Depth 2: GpuHashJoin, HashKeys: (aid), JoinQual: (aid = aid)                        Nrows (in/out: 100.00%), KDS-Hash (size: 12.04MB, nbatches: 1)               ->  Custom Scan (BulkScan) on t0  (cost=0.00..1833334.80 rows=100000080 width=12)               ->  Seq Scan on t2  (cost=0.00..1935.00 rows=100000 width=4)               ->  Seq Scan on t1  (cost=0.00..1935.00 rows=100000 width=12)(14 rows)</pre><p><span lang="en">In the above example, we can see GpuJoin and GpuPreAgg to process relation's join and partial aggregation, by PG-Strom.On the other hands, once we turned off <tt>PG-Strom</tt>, then same query generate different query execution plan.</span><span lang="ja">上記の例では、PG-Stromの提供するGpuJoinとGpuPreAggがそれぞれジョインと部分集約演算を実行します。 一方、いったんPG-Stromを無効化すると、同一のクエリが異なった実行計画を生成します。</span></p><pre>postgres=# SET pg_strom.enabled = off;SETpostgres=# EXPLAIN           SELECT cat, avg(ax) FROM t0 NATURAL JOIN t1 NATURAL JOIN t2 GROUP BY cat;                                    QUERY PLAN----------------------------------------------------------------------------------- HashAggregate  (cost=6824660.14..6824660.47 rows=26 width=12)   Group Key: t0.cat   ->  Hash Join  (cost=7250.00..6328026.92 rows=99326645 width=12)         Hash Cond: (t0.aid = t1.aid)         ->  Hash Join  (cost=3576.00..4182132.55 rows=99326645 width=8)               Hash Cond: (t0.bid = t2.bid)               ->  Seq Scan on t0  (cost=0.00..1833334.80 rows=100000080 width=12)               ->  Hash  (cost=1935.00..1935.00 rows=100000 width=4)                     ->  Seq Scan on t2  (cost=0.00..1935.00 rows=100000 width=4)         ->  Hash  (cost=1935.00..1935.00 rows=100000 width=12)               ->  Seq Scan on t1  (cost=0.00..1935.00 rows=100000 width=12)(11 rows)</pre><p><span lang="en">Here is no CustomScan node, thus PG-Strom is not responsible to execution of the query.</span><span lang="ja">CustomScanが出現していません、したがって、PG-Stromはこのクエリの実行に関与しません。</span></p></section><h2 id="reference_types">  <span lang="en">Reference:Data Types</span>  <span lang="ja">リファレンス：データ型</span></h2><h2 id="reference_functions">  <span lang="en">Reference:Functions and Operators</span>  <span lang="ja">リファレンス：関数と演算子</span></h2><h2 id="reference_configs">  <span lang="en">Reference:Config Options</span>  <span lang="ja">リファレンス：設定パラメータ</span></h2></article>